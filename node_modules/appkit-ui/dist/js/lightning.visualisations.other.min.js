/*! appkit-ui 2018-09-10 */
!function(){"use strict";function a(){var a={restrict:"E",transclude:!0,scope:{value:"@",min:"@",max:"@",title:"@",stops:"=?",valueSuffix:"@"},controller:["$scope","$timeout",function(a,b){function c(b){a.chartConfig.exporting=b}function d(b){a.chartConfig.credits=b}var e=this;e.addExportingOptions=c,e.addCreditOptions=d,a.defaultStops=[[.1,"#DF5353"],[.5,"#DDDF0D"],[.9,"#55BF3B"]],a.stops=null==a.stops?a.defaultStops:a.stops,a.$watch("value",function(b){b&&(a.chartConfig.series[0].data[0]=parseInt(b))}),a.$watch("min",function(b){b&&(a.chartConfig.yAxis.min=parseInt(b))}),a.$watch("max",function(b){b&&(a.chartConfig.yAxis.max=parseInt(b),a.chartConfig.yAxis.tickInterval=parseInt(a.max))}),a.chartConfig={chart:{type:"solidgauge"},pane:{center:["50%","85%"],size:"140%",startAngle:-90,endAngle:90,background:{backgroundColor:"#EEE",innerRadius:"60%",outerRadius:"100%",shape:"arc"}},plotOptions:{solidgauge:{dataLabels:{y:5,borderWidth:0,useHTML:!0}}},tooltip:{enabled:!1},exporting:{enabled:!1},series:[{data:[parseInt(a.value)],dataLabels:{borderWidth:0,format:'<div style="text-align:center"><span style="font-size:25px;color:black">{y}</span><br/><span style="font-size:12px;color:silver">'+(null==a.valueSuffix?"<br/>":a.valueSuffix)+"</span></div>"}}],title:{text:a.title,y:50},yAxis:{min:parseInt(a.min),max:parseInt(a.max),title:{y:140},stops:a.stops,lineWidth:0,minorTickInterval:null,tickInterval:a.max,tickWidth:0,labels:{y:15}},loading:!1,func:function(a){b(function(){a.reflow()},0)}}}],template:function(){return'<div ng-if="value != null" class="solid-gauge-chart"><ng-transclude></ng-transclude><highchart config="chartConfig"></highchart></div>'}};return a}angular.module("lightning").directive("chartGauge",a)}(),function(){"use strict";function a(){var a={restrict:"E",scope:{facet:"=?",facetName:"@",action:"@"},require:"^?searchFacet",controller:["$scope","$lightningUrl","$attrs","$filter","$location","QueryService","ResponseService",function(a,b,c,d,e,f,g){function h(){a.settingFilter=!1,a.maxCount=a.facet["max-count"],null!=c.title&&""!=c.title.trim()&&(a.title=c.title),a.filters=angular.copy(a.facet.filters),a.filters=d("limitTo")(a.filters,a.show),angular.forEach(a.filters,function(b){b.act=d("actualValue")(b.val),b.dsp=d("displayValue")(b.val),b.height=b.count>0?b.count/a.maxCount*100:0,b.ngDsp=b.dsp,c.dateFormat?b.val&&b.val.act&&b.val.act.type&&"range"==b.val.act.type?b.ngDsp=d("rangeDateFormat")(b.val,c.dateFormat):"undefined"!=typeof b.ngDsp.indexOf?0==b.ngDsp.indexOf("<")?(b.ngDsp=b.ngDsp.substring(1),b.ngDsp=d("dateFormat")(b.ngDsp.trim(),c.dateFormat),b.ngDsp="< "+b.ngDsp):0==b.ngDsp.indexOf(">")?(b.ngDsp=b.ngDsp.substring(1),b.ngDsp=d("dateFormat")(b.ngDsp.trim(),c.dateFormat),b.ngDsp="> "+b.ngDsp):b.ngDsp=d("dateFormat")(b.dsp,c.dateFormat):b.ngDsp=d("dateFormat")(b.dsp,c.dateFormat):a.maxChars>-1&&(b.ngDsp=d("maxCharacters")(b.dsp,a.maxChars))})}a.show=parseInt(c.show)?parseInt(c.show):20,a.maxChars=parseInt(c.maxCharacters)?parseInt(c.maxCharacters):20,a.settingFilter=!1,a.height=null==c.height?"100px":c.height,null!=c.response?(a.response=g.getResponse(c.response),a.response&&(a.facet=a.response.facets[a.facetName]||a.facet,h()),a.$on(c.response+"_updated",function(){a.response=g.getResponse(c.response),a.facet=a.response.facets[a.facetName]||a.facet,h()})):a.$watch("facet",function(b){b&&(a.facet=b,h())}),a.applyFilter=function(d){if(!a.settingFilter){a.settingFilter=!0;var g=d.act,h=d.dsp;if(c.dateFormat&&(h=d.ngDsp),null!=c.query){var i=f.getQueryAsHttpParams(c.query,!0);null!=i&&b.setUrlParameters(i,!1)}null!=a.action?(null!=d.val.act&&"range"==d.val.act.type?b.addRangeFilterDisplayToUrl(a.facet.id,d.val.act.from,d.val.act.to,h,!1,!1,d.val.act.fromExcluded,d.val.act.toExcluded):b.addRangeFilterDisplayToUrl(a.facet.id,g,g,h,!1,!1,!1,!1),e.path(a.action)):null!=d.val.act&&"range"==d.val.act.type?b.addRangeFilterDisplayToUrl(a.facet.id,d.val.act.from,d.val.act.to,h,!0,!1,d.val.act.fromExcluded,d.val.act.toExcluded):b.addRangeFilterDisplayToUrl(a.facet.id,g,g,h,!0,!1,!1,!1)}}}],link:function(a,b,c,d){null!=d&&a.facet&&(a.facet.filters.length>1?d.showFacet(!0):d.showFacet(!1))},template:function(a,b){var c="";return c+='<div class="histogram-container" ng-show="facet.filters.length > 1">',null!=b.title&&(c+='<h3 class="facet-title">{{::title}}</h3>'),c+='<ol class="histogram bars-{{facet.filters.length > show ? show : facet.filters.length}}">',c+='<li ng-style="::{\'height\': height}" ng-repeat="filter in filters">',c+='<div class="bar" ng-style="::{\'height\':filter.height + \'%\'}" ng-click="applyFilter(filter)">',c+="<label>{{::filter.ngDsp}}","true"==b.showCount&&(c+='<span class="histogram-metadata"><span class="count"> ({{::filter.count}})</span></span>'),c+="</label>",c+="</div>",c+="</li>",c+="</ol>",c+="</div>"}};return a}angular.module("lightning").directive("chartHistogram",a)}(),function(){"use strict";function a(){var a={restrict:"E",scope:{response:"=?",facet:"=?",facetName:"@",action:"@"},controller:["$scope","$lightningUrl","$attrs","$filter","$location",function(a,b,c,d,e){function f(){a.settingFilter=!1,null==a.facet?a.facet={filters:[]}:(a.maxCount=a.facet["max-count"],a.minCount=a.facet["min-count"],a.level=a.maxCount/c.numberOfLevels,null!=c.title&&""!=c.title.trim()&&(a.title=c.title))}a.show=parseInt(c.show)?parseInt(c.show):15,a.settingFilter=!1,c.numberOfLevels=parseInt(c.numberOfLevels)?parseInt(c.numberOfLevels):10,null!=c.response?a.$watch("response",function(b){b&&(a.response=b,a.facet=a.response.facets[a.facetName]||a.facet,f())}):a.$watch("facet",function(b){b&&(a.facet=b,f())}),a.getWeighting=function(b){a.maxCount=a.facet["max-count"],a.minCount=a.facet["min-count"],a.level=a.maxCount/c.numberOfLevels;for(var d=1;d<=c.numberOfLevels;){if(b>a.level*(d-1)&&b<=a.level*d)return d;d++}},a.applyFilter=function(c){a.settingFilter||(a.settingFilter=!0,null!=a.action?(b.addFilterToUrl(a.facet.id,d("actualValue")(c.val),d("displayValue")(c.val),!1),e.path(a.action)):b.addFilterToUrl(a.facet.id,d("actualValue")(c.val),d("displayValue")(c.val),!0))},a.greaterThan=function(a,b){return function(c){if(null!=c[a]&&c[a]>b)return!0}}}],template:function(a,b){var c,d,e=["val","count","weight"];null!=b.order&&0==b.order.indexOf("-")?(c=!0,d=b.order.substring(1)):null!=b.order&&0==b.order.indexOf("+")?(c=!1,d=b.order.substring(1)):(c=!1,d=b.order);var f=e.indexOf(d)!=-1?e[e.indexOf(d)]:"val",g="";return g+='<h3 class="facet-title" ng-show="title != null">{{::title}}</h3>',g+='<div class="tagcloud">',g+="<ol>",g+="<li ng-repeat=\"filter in facet.filters | filter:greaterThan('count',0) | orderBy:'"+f+"' : "+c+' | limitTo: show" class="level{{getWeighting(filter.count)}}">',g+='<a href="javascript:void(0);" ng-click="applyFilter(filter)">{{::filter.val | displayValue}}</a>',g+="</li>",g+="</ol>",g+="</div>"}};return a}angular.module("lightning").directive("chartTagcloud",a)}(),function(){"use strict";function a(a,b,c,d,e){var f={restrict:"E",scope:{},transclude:!0,replace:!0,link:function(f,g,h){function i(){if(f.response.results&&f.response.results.length>0){var b=m(f.response.results);f.groups=a.groupByDateRanges(b,h.date)}}function j(){f.platform=d.getPlatform(h.platform);var g=e.getQueryAsHttpParams(h.query),i=b.getParams(p,g);return void 0!=i.searchParams.p&&i.searchParams.p>o?(i.searchParams.p=i.searchParams.p+1,o=i.searchParams.p):(o+=1,i.searchParams.p=o),i.searchParams.p>f.lastPage?(f.loading=!1,void(f.disabled=!0)):void c.search(i.query,f.platform,i.searchParams).then(function(b){p=!0,angular.forEach(b.data.results,function(a){f.response.results.push(a)});var c=m(f.response.results);f.groups=a.groupByDateRanges(c,h.date),f.lastPage=b.data.hits.act[1]/b.data.query.rpp,b.data.hits.act[1]%b.data.query.rpp>0&&(f.lastPage+=1),f.lastPage=Math.floor(f.lastPage),f.loading=!1},function(){p=!0,f.loading=!1})}function k(){if(!f.loading&&!f.disabled){var a="horizontal"==h.orientation,b=l(q,30,a);b&&(f.loading=!0,j())}}function l(a,b,c){var d=c?a.scrollLeft:a.scrollTop,e=c?a.offsetWidth:a.offsetHeight,f=c?a.scrollWidth:a.scrollHeight;return d+e>=f-b}function m(b){var c;if(h.sort){var d="oldest"==h.sort;c=a.dateSortResults(b,h.date,d)}else c=b;return c}f.response=b.getResponse(h.response);var n=f.$on(h.response+"_updated",function(a,b){f.response=b,null!=f.response&&i()});f.$on("$destroy",function(){n()}),null!=f.response&&i();var o=1,p=!1;if(h.platform&&null!=h.query){var q=g[0];g.bind("scroll",k),f.$on("$destroy",function(){g.unbind("scroll",k)})}},template:function(a,b){var c=b.orientation||"vertical",d='style="',e=!1;b.maxHeight&&(d+="max-height: "+b.maxHeight+"px;",e=!0),b.maxWidth&&(d+="max-width: "+b.maxWidth+"px;",e=!0),d+='"',d=e?d:"";var f="";return f+='<div class="tk-stl-timeline-container" '+d+">",f+='<ul class="tk-stl-timeline '+c+'">',f+='<li class="time-slot" ng-repeat="milestone in groups">',f+='<div class="milestone">{{ milestone.label }}</div>',f+='<div class="events">',f+='<div class="entry" ng-repeat="event in milestone.events" ng-inject>',f+='<div class="content">{{ event.result.fields.name.val[0] }}</div>',f+="<div class=\"metadata\">{{ event.result.fields[attributes.date].val[0] | date:'medium' }}</div>",f+="</div>",f+="</div>",f+="</li>",f+="</ul>",f+="</div>"}};return f}angular.module("lightning").directive("chartTimeline",a),a.$inject=["DateUtils","ResponseService","$twigkit","PlatformService","QueryService"]}();